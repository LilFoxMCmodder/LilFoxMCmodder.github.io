/* ===== Tunables / defaults (HIGH tier) ===== */
:root{
  --blue-0:#07122b;   /* darkest corners */
  --blue-1:#0a1c3d;   /* base */
  --blue-2:#0f2b6a;   /* mid */
  --cyan  :#22c1ff;   /* sweep color core */
  --accent:#4aa8ff;   /* edge tint */

  --vignette: rgba(0,0,0,.55);
  --grain: rgba(255,255,255,.02);

  /* motion (high) */
  --dur-1: 9s;     /* main bar */
  --dur-2: 12s;    /* secondary bar */
  --dur-3: 16s;    /* wide soft bar */
  --dur-4: 20s;    /* long faint bar */

  --blur: 18px;    /* glow blur */
  --sat : 115%;    /* saturation */
  --op  : .65;     /* base opacity */

  --bars: 4;       /* how many bars we show (used by tier rules) */
}

/* ===== Performance tiers ===== */

/* Medium tier: fewer bars, longer durations, less blur/sat */
html[data-tier="med"]{
  --dur-1: 14s;
  --dur-2: 18s;
  --dur-3: 22s;
  --dur-4: 26s;
  --blur: 12px;
  --sat : 108%;
  --op  : .55;
  --bars: 2;  /* only s1 + s2 */
}

/* Low tier: minimal motion, single bar, no blend/blur */
html[data-tier="low"]{
  --dur-1: 22s;
  --blur: 0px;     /* drop blur (expensive) */
  --sat : 100%;
  --op  : .38;
  --bars: 1;       /* only s1 */
}

/* Reset */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; overflow:hidden; background:var(--blue-1);
  -webkit-font-smoothing:antialiased; /* minor perf */
  backface-visibility:hidden;
}

/* ===== Base background + glow + vignette ===== */
.bg{
  position:fixed; inset:0; isolation:isolate;
  background:
    radial-gradient(120% 85% at 50% 60%, var(--blue-2) 0%, var(--blue-1) 46%, var(--blue-0) 100%);
}

/* Soft center glow (skip on low tier to cut paint cost) */
.bg::before{
  content:""; position:absolute; inset:-10%;
  background: radial-gradient(48% 42% at 50% 55%,
    rgba(74,168,255,.9) 0%,
    rgba(74,168,255,.18) 22%,
    rgba(20,75,154,.12) 42%,
    rgba(10,28,61,.06) 60%,
    rgba(7,18,43,0) 72%);
  filter: blur(var(--blur)) saturate(var(--sat));
  z-index:0; will-change: filter, transform, opacity;
}
html[data-tier="low"] .bg::before{ display:none }

/* Edge vignette */
.bg::after{
  content:""; position:absolute; inset:0; pointer-events:none;
  background:
    radial-gradient(120% 100% at 50% 55%, transparent 55%, var(--vignette) 100%),
    radial-gradient(100% 100% at 8% 8%, transparent 55%, rgba(0,0,0,.42) 100%),
    radial-gradient(100% 100% at 92% 92%, transparent 55%, rgba(0,0,0,.42) 100%);
  z-index:3;
}

/* ===== Sweeping light bars ===== */
.sweep{
  position:absolute; inset:-10% -20%;
  pointer-events:none; z-index:1;
  opacity:var(--op);
  filter: blur(var(--blur)) saturate(var(--sat));
  transform: translate3d(-40%,0,0);          /* GPU-friendly */
  background:
    linear-gradient(90deg,
      rgba(0,0,0,0) 0%,
      rgba(255,255,255,.06) 34%,
      var(--accent) 46%,
      var(--cyan)   50%,
      var(--accent) 54%,
      rgba(255,255,255,.06) 66%,
      rgba(0,0,0,0) 100%);
  will-change: transform, opacity, filter;
  /* mix-blend is prettyâ€”but expensive; only keep on high/med */
  mix-blend-mode: screen;
}
html[data-tier="low"] .sweep{
  mix-blend-mode: normal; /* cheaper */
}

/* Personalities */
.s1{
  animation: sweepX var(--dur-1) ease-in-out infinite alternate,
             breathe 6s ease-in-out infinite;
  transform-origin: 50% 50%;
}
.s2{
  animation: sweepX var(--dur-2) ease-in-out infinite alternate-reverse,
             tilt 14s ease-in-out infinite;
  opacity: calc(var(--op) - .1);
  transform: rotate(6deg) translate3d(-60%,0,0);
}
.s3{
  animation: sweepX var(--dur-3) ease-in-out infinite alternate;
  opacity: calc(var(--op) - .3);
  transform: rotate(-7deg) translate3d(-60%,0,0) scaleY(1.2);
}
.s4{
  animation: sweepX var(--dur-4) ease-in-out infinite alternate-reverse;
  opacity: calc(var(--op) - .37);
  transform: rotate(12deg) translate3d(-60%,0,0) scaleY(1.35);
}

/* Hide extra bars on lower tiers */
html[data-tier="med"] .s3,
html[data-tier="med"] .s4{ display:none }
html[data-tier="low"] .s2,
html[data-tier="low"] .s3,
html[data-tier="low"] .s4{ display:none }

/* Keyframes (transform-only for GPU) */
@keyframes sweepX{
  0%   { transform: translate3d(-60%,0,0) }
  50%  { transform: translate3d(20%,0,0) }
  100% { transform: translate3d(140%,0,0) }
}

/* Subtle breathing */
@keyframes breathe{
  0%,100% { opacity: var(--op); filter: blur(var(--blur)) saturate(var(--sat)); }
  50%     { opacity: calc(var(--op) + .13); filter: blur(calc(var(--blur) - 4px)) saturate(calc(var(--sat) + 10%)); }
}

/* Gentle tilt/rock */
@keyframes tilt{
  0%,100% { transform: rotate(6deg) translate3d(-60%,0,0); }
  50%     { transform: rotate(2deg) translate3d(-60%,0,0); }
}

/* Optional animated grain (disable on low) */
body::before{
  content:""; position:fixed; inset:-10%;
  background: repeating-radial-gradient(circle at 50% 50%, var(--grain) 0 .7px, transparent .7px 2px);
  opacity:.10; mix-blend-mode:soft-light; filter: blur(.4px);
  animation: grain 1.8s steps(6) infinite;
  z-index:2; pointer-events:none;
  will-change: transform;
}
@keyframes grain{ to { transform: translate3d(2%,-2%,0) } }
html[data-tier="low"] body::before{ display:none }

/* Respect OS setting */
@media (prefers-reduced-motion: reduce){
  .sweep, body::before, .s1, .s2, .s3, .s4 { animation: none !important; }
}
